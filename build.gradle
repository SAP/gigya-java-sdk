apply plugin: 'java'

repositories {
    mavenCentral()
}

version = '3.2.7'

dependencies {
    testImplementation 'junit:junit:4.13.2'
    testImplementation 'org.json:json:20230227'
    testImplementation 'org.skyscreamer:jsonassert:1.5.0'
    testImplementation 'org.mockito:mockito-core:4.6.1'
    testImplementation 'org.powermock:powermock-module-junit4:1.7.4'
    testImplementation 'org.powermock:powermock-api-mockito2:1.7.4'

    compileOnly 'org.json:json:20230227'
}

//create a single Jar with all dependencies
tasks.register('build-sdk', Jar) {
    archivesBaseName = 'gigya-sdk'
    duplicatesStrategy = DuplicatesStrategy.EXCLUDE
    from { configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}

tasks.register('sources-sdk', Jar) {
    from sourceSets.main.allJava
    archivesBaseName = 'gigya-sdk'
    archiveClassifier = "sources"
}

tasks.register('createDistribution', GradleBuild) {
    tasks = ['clean', 'build', 'sources']
}
